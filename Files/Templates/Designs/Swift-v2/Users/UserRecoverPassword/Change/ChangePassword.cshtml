@inherits Dynamicweb.Rendering.ViewModelTemplate<Dynamicweb.Users.Frontend.RecoverPasswordModule.UserPasswordRecoverViewModel>
@using Dynamicweb
@using System.Collections.Generic
@using System.Linq
@using Dynamicweb.Users.Frontend.RecoverPasswordModule

<div class="mx-auto" style="max-width: 30rem;">
    <div class="text-center p-4 border-bottom">
        <h4 class="display-6 m-0">@Translate("Reset your password")</h4>
        <p class="card-text">@Translate("Enter and confirm your new password.")</p>
    </div>

    <div class="p-4">
        @if (Model.Result == RecoverPasswordResultType.MismatchedPasswords)
        {
            <div class="alert alert-info" role="alert">
                @Translate("Passwords don't match")
            </div>
        }

        @if (Model.Result == RecoverPasswordResultType.InvalidPasswordLength)
        {
            <div class="alert alert-info" role="alert">
                @Translate("Password not accepted: Length is not valid")
            </div>
        }

        @if (Model.Result == RecoverPasswordResultType.InvalidPasswordComplexity)
        {
            <div class="alert alert-info" role="alert">
                @Translate("Password not accepted: {errorMessage.TrimEnd('.')}.")
            </div>
        }

        @if (Model.Result == RecoverPasswordResultType.Success)
        {
            <div class="alert alert-info" role="alert">
                @Translate("Password changed")
            </div>
        }

        <form method="post">
            <input type="hidden" name="UserRecoverPassword" value="true"/>
            <div class="form-floating mb-3">
                <input type="password" name="NewPassword" id="NewPassword" class="form-control" placeholder="@Translate("NewPassword")" required>
                <label for="NewPassword">@Translate("NewPassword")</label>
            </div>

            <div class="form-floating mb-3">
                <input type="password" name="ConfirmNewPassword" id="ConfirmNewPassword" class="form-control" placeholder="@Translate("ConfirmNewPassword")" required>
                <label for="ConfirmNewPassword">@Translate("ConfirmNewPassword")</label>
            </div>

            <div class="grid grid-1">
                <button type="submit" name="LoginAction" value="Recovery" class="btn btn-primary btn-lg" id="PasswordRecoveryButton">@Translate("Change password")</button>
                <a href="/Default.aspx?ID=@GetPageIdByNavigationTag("SignInPage")" class="btn btn-link" id="BackToSignInButton">@Translate("Nevermind, back to sign in")</a>
            </div>
        </form>     
    </div>
</div>

