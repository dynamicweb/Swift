@inherits ViewModelTemplate<AddressViewModel>
@using Dynamicweb.Rendering
@using Dynamicweb.Frontend

@{
    string title = Model.Id == 0 ? "New address" : "Edit address";
}

<div class="offcanvas-header">
    <h5 class="offcanvas-title m-0">@Translate(title)</h5>
    <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="@Translate("Close")"></button>
</div>

<form method="post" class="offcanvas-body d-flex flex-column gap-2">
    <input type="hidden" name="ID" value="@Pageview.ID">
    <input type="hidden" name="AddressId" value="@Model.Id">
    <input type="hidden" name="redirect" value="false">

    <div class="form-floating">
        <input type="text" class="form-control" placeholder="@Translate("Name")" name="Name" id="Name" value="@Model.Name" required>
        <label for="Name" class="form-label">@Translate("Name")</label>
    </div>

    <div class="form-floating">
        <input type="email" class="form-control" placeholder="@Translate("Email")" name="Email" id="Email" value="@Model.Email">
        <label for="Email" class="form-label">@Translate("Email")</label>
    </div>

    <div class="form-floating">
        <input type="text" class="form-control" placeholder="@Translate("Address")" name="Address" id="Address" value="@Model.Address" required />
        <label for="Address" class="form-label">@Translate("Address")</label>
    </div>

    <div class="form-floating">
        <input type="text" class="form-control" placeholder="@Translate("Additional address")" name="Address2" id="Address2" value="@Model.Address2" />
        <label for="Address2" class="form-label">@Translate("Additional address")</label>
    </div>

    <div class="form-floating">
        <input type="text" class="form-control" placeholder="@Translate("House number")" name="HouseNumber" id="HouseNumber" value="@Model.HouseNumber" />
        <label for="HouseNumber" class="form-label">@Translate("House number")</label>
    </div>

    <div class="form-floating">
        <input type="text" class="form-control" placeholder="@Translate("Zip code")" name="Zip" id="Zip" value="@Model.Zip" required />
        <label for="Zip" class="form-label">@Translate("Zip code")</label>
    </div>

    <div class="form-floating">
        <input type="text" class="form-control" placeholder="@Translate("City")" name="City" id="City" value="@Model.City" required />
        <label for="City" class="form-label">@Translate("City")</label>
    </div>

    @* Implement regions correctly *@

    <div class="form-floating">
        <input type="text" class="form-control" placeholder="@Translate("State or region")" name="State" id="State" value="@Model.State" />
        <label for="State" class="form-label">@Translate("State or region")</label>
    </div>

    <div class="form-floating">
        <select class="form-select" id="CountryCode" name="CountryCode" onchange="submitForm()">
            @foreach (var country in Dynamicweb.Ecommerce.Services.Countries.GetCountries())
            {
                string selected = country.Code2 == Model.CountryCode ? "selected" : string.Empty;
                <option value="@country.Code2" @selected>@country.GetName(Pageview.Area.EcomLanguageId)</option>
            }
        </select>
        <label for="CountryCode" class="form-label">@Translate("Country")</label>
    </div>

    <div class="form-check my-3 flex-fill">
        <input type="checkbox" class="form-check-input" name="IsDefault" id="IsDefault" @(Model.IsDefault ? "checked" : "")>
        <label for="IsDefault" class="form-check-label">@Translate("Default address")</label>
    </div>

    <div class="d-flex gap-2 justify-content-end">
        <button type="submit" name="AddressCmd" value="SaveAddress" data-bs-dismiss="offcanvas" class="btn btn-primary" id="SaveAddressButton">
            @Translate("Save")
        </button>
    </div>
</form>

