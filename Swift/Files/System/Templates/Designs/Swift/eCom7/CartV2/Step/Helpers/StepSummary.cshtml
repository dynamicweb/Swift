@inherits Dynamicweb.Rendering.RazorTemplateBase<Dynamicweb.Rendering.RazorTemplateModel<Dynamicweb.Rendering.Template>>

@{
	bool summaryIsPaymentStep = GetLoop("StepButtons").Count == 0;
	int summaryCurrentStep = !summaryIsPaymentStep ? 1 : 4;
	int summaryCurrentUserId = Dynamicweb.Core.Converter.ToInt32(GetGlobalValue("Global:Extranet.UserID"));

	foreach (LoopItem step in GetLoop("StepButtons"))
	{
		if (step.GetBoolean("Step.Current"))
		{
			summaryCurrentStep = step.GetInteger("Step.Number");
		}
	}
}

@if (!string.IsNullOrEmpty(GetString("UserManagement:User.Address")) ||
	!string.IsNullOrEmpty(GetString("Ecom:Order.ShippingMethodID")) ||
	!string.IsNullOrEmpty(GetString("Ecom:Order.PaymentMethodID")) ||
	!string.IsNullOrEmpty(GetString("Ecom:Order.Delivery.Name")) ||
	!string.IsNullOrEmpty(GetString("Ecom:Order.Delivery.Company")) ||
	!string.IsNullOrEmpty(GetString("Ecom:Order.Delivery.Address")) ||
	!string.IsNullOrEmpty(GetString("Ecom:Order.Delivery.Address2")) ||
	!string.IsNullOrEmpty(GetString("Ecom:Order.Delivery.Zip")) ||
	!string.IsNullOrEmpty(GetString("Ecom:Order.Delivery.City")) ||
	!string.IsNullOrEmpty(GetString("Ecom:Order.Delivery.Email")) ||
	!string.IsNullOrEmpty(GetString("Ecom:Order.Delivery.Phone")) ||
	!string.IsNullOrEmpty(GetString("Ecom:Order.Customer.Name")) ||
	!string.IsNullOrEmpty(GetString("Ecom:Order.Customer.Company")) ||
	!string.IsNullOrEmpty(GetString("Ecom:Order.Customer.Address")) ||
	!string.IsNullOrEmpty(GetString("Ecom:Order.Customer.Address2")) ||
	!string.IsNullOrEmpty(GetString("Ecom:Order.Customer.Zip")) ||
	!string.IsNullOrEmpty(GetString("Ecom:Order.Customer.City")) ||
	!string.IsNullOrEmpty(GetString("Ecom:Order.Customer.Email")) ||
	!string.IsNullOrEmpty(GetString("Ecom:Order.Customer.Phone")) ||
	!string.IsNullOrEmpty(GetString("Ecom:Order.ShippingMethod")) ||
	!string.IsNullOrEmpty(GetString("Ecom:Order.ShippingDate")) ||
	!string.IsNullOrEmpty(GetString("Ecom:Order.PaymentMethod")))
{
	@* User *@
	if (summaryCurrentUserId != 0)
	{
		<div class="list-group mb-5">
			@{ 
				<text>
				@Include("StepSummaryOrderCustomer.cshtml")
				</text>
				<text>
				@Include("StepSummaryUser.cshtml")
				</text>
			}

			@if (summaryCurrentStep != 1)
			{
				<text>
				@Include("StepSummaryOrderDelivery.cshtml")
				</text>
				<text>
				@Include("StepSummaryDeliveryMethod.cshtml")
				</text>
				<text>
				@Include("StepSummaryDeliveryDate.cshtml")
				</text>
			}
		</div>
	}

	@* Anonymous *@
	else
	{
		if (summaryCurrentStep != 1)
		{
			<div class="list-group">
				@{ 
					<text>
					@Include("StepSummaryOrderCustomer.cshtml")
					</text>
					<text>
					@Include("StepSummaryOrderDelivery.cshtml")
					</text>
				}

				@if (summaryCurrentStep > 2)
				{
					<text>
					@Include("StepSummaryDeliveryMethod.cshtml")
					</text>
					<text>
					@Include("StepSummaryDeliveryDate.cshtml")
					</text>
				}
				@if (summaryCurrentStep > 3)
				{
					<text>
					@Include("StepSummaryPaymentMethod.cshtml")
					</text>
					<text>
					@Include("StepSummaryOrderReference.cshtml")
					</text>
				}
			</div>
		}
	}
}







